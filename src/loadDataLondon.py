import csv
import numpy as np
import sklearn
import pandas as pd

days = 2

print("-------------------------- MERGE DATAS  --------------------------")

testDates = ['2018-03-21 00:00:00','2018-03-21 01:00:00','2018-03-21 02:00:00','2018-03-21 03:00:00','2018-03-21 04:00:00','2018-03-21 05:00:00','2018-03-21 06:00:00','2018-03-21 07:00:00','2018-03-21 08:00:00','2018-03-21 09:00:00','2018-03-21 10:00:00','2018-03-21 11:00:00','2018-03-21 12:00:00','2018-03-21 13:00:00','2018-03-21 14:00:00','2018-03-21 15:00:00','2018-03-21 16:00:00','2018-03-21 17:00:00','2018-03-21 18:00:00','2018-03-21 19:00:00','2018-03-21 20:00:00','2018-03-21 21:00:00','2018-03-21 22:00:00','2018-03-21 23:00:00','2018-03-22 00:00:00','2018-03-22 01:00:00','2018-03-22 02:00:00','2018-03-22 03:00:00','2018-03-22 04:00:00','2018-03-22 05:00:00','2018-03-22 06:00:00','2018-03-22 07:00:00','2018-03-22 08:00:00','2018-03-22 09:00:00','2018-03-22 10:00:00','2018-03-22 11:00:00','2018-03-22 12:00:00','2018-03-22 13:00:00','2018-03-22 14:00:00','2018-03-22 15:00:00','2018-03-22 16:00:00','2018-03-22 17:00:00','2018-03-22 18:00:00','2018-03-22 19:00:00','2018-03-22 20:00:00','2018-03-22 21:00:00','2018-03-22 22:00:00','2018-03-22 23:00:00']

stations = ['BL0', 'BX1', 'BX9', 'CD1', 'CD9', 'CR8', 'CT2', 'CT3', 'GB0', 'GN0', 'GN3', 'GR4', 'GR9', 'HR1', 'HV1', 'KC1', 'KF1', 'LH0', 'LW2', 'MY7', 'RB7', 'ST5', 'TD5', 'TH4']
load_datas = []
for s in stations :
    print(s)
    all = pd.read_csv('../final_project_data/merge/'+s+'.csv')
    print(all.shape)
    if s == 'CT2' :
        startDate = 9240
        endDate = 9287
    else :
        startDate = 10656
        endDate = 10703
    X_test = all.loc[startDate:endDate,[temperature','pressure','humidity','wind_direction','wind_speed/kph','PM2.5 (ug-m3)','PM10 (ug-m3)','NO2 (ug-m3)']].to_numpy()
    y_test = all.loc[startDate:endDate,['PM2.5 (ug-m3)','PM10 (ug-m3)','NO2 (ug-m3)']].to_numpy()
    X = all[['temperature','pressure','humidity','wind_direction','wind_speed/kph','PM2.5 (ug-m3)','PM10 (ug-m3)','NO2 (ug-m3)']].to_numpy()
    y = all[['PM2.5 (ug-m3)','PM10 (ug-m3)','NO2 (ug-m3)']].to_numpy()
    print(X.shape)
    print(y.shape)
    print(X[0]) # tests see right id station
    print(y[0])
    X_train, X_val = X[:200], X[200:300]
    y_train, y_val = y[days*24:200+days*24], y[200+days*24:300+days*24]
